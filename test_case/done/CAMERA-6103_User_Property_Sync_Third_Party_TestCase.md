# CAMERA-6103 Android ç”¨æˆ¶å±¬æ€§åŒæ­¥ç¬¬ä¸‰æ–¹æœå‹™æ¸¬è©¦æ¡ˆä¾‹

## ğŸ“‹ æ¸¬è©¦æ¦‚è¿°

**Ticket**: CAMERA-6103  
**åŠŸèƒ½**: [Android] Sync the user properties to Appcues to fix the latency issue from the server side  
**Parent Epic**: [CAMERA-6093](https://alfredlabs.atlassian.net/browse/CAMERA-6093) - Fix the latency issue of server-side user properties syncing to Appcues  
**æŠ€è¡“è¦æ ¼æ–‡ä»¶**: [User Property Sync Mechanism for Third-Party Services](https://alfredlabs.atlassian.net/wiki/spaces/PD/pages/4485054466/User+Property+Sync+Mechanism+for+Third-Party+Services)  
**Fix Versions**: Android - 2025.26.0  
**å»ºç«‹æ—¥æœŸ**: 2025-12-10  
**è² è²¬äºº**: QA Team - Jessie  
**ç‹€æ…‹**: Testing

**ç”¢å“å°ˆæœ‰åè©åƒè€ƒ**ï¼šæœ¬æ¸¬è©¦æ¡ˆä¾‹ä¸­ä½¿ç”¨çš„å°ˆæœ‰åè©è«‹åƒè€ƒ [Terminology Table v2](https://alfredlabs.atlassian.net/wiki/spaces/~590960658/pages/3834085744/Terminology+Table+v2)

### è®Šæ›´é‡é»
æœ¬ PR ç‚ºè§£æ±º Server Side åŒæ­¥ User Properties åˆ° Third-Partyï¼ˆAppcuesã€RevenueCatã€Amplitudeï¼‰æ™‚æœƒæœ‰ 5-10 åˆ†é˜å»¶é²çš„å•é¡Œï¼Œæ–°å¢ Client ç«¯åŒæ­¥æ©Ÿåˆ¶ï¼Œè®“ User Properties èƒ½å¤ å³æ™‚åŒæ­¥ï¼Œç¢ºä¿æ­£ç¢ºçš„æŠ•æ”¾å°è³¼åŠæºé€šã€‚

**è®Šæ›´è¦æ¨¡**ï¼š679 additions, 173 deletionsï¼ˆåˆè¨ˆ 852 è¡Œè®Šæ›´ï¼‰ï¼Œä¿®æ”¹ 19 å€‹æª”æ¡ˆ

### æ ¸å¿ƒè®Šæ›´
1. **æ–°å¢ User Propertiesï¼ˆ8 å€‹ï¼‰**ï¼š
   - `eligible_hw_free_trial` (String) - æ—¢æœ‰æ¬„ä½ï¼Œæœ¬æ¬¡æ–°å¢è‡³ API Response
   - `is_alfredcam_owner` (Boolean) - æ–°å¢æ¬„ä½
   - `subscription_tier` (String) - æ–°å¢æ¬„ä½
   - `subscription_cycle_iso` (String) - æ–°å¢æ¬„ä½
   - `subscription_cycle_first` (Boolean) - æ–°å¢æ¬„ä½
   - `subscription_channel` (String) - æ–°å¢æ¬„ä½
   - `subscription_cancelled` (Boolean) - æ–°å¢æ¬„ä½
   - `subscription_expiration_date` (String) - æ–°å¢æ¬„ä½ï¼ˆä¸åŒæ­¥è‡³ RCï¼‰
   - `subscription_product_id` (String) - æ–°å¢æ¬„ä½

2. **API è®Šæ›´**ï¼š
   - **æ—¢æœ‰ API** (`GET "/v2.6/device/pairing/{code}/paired"`)ï¼šæ–°å¢ Response æ¬„ä½ `eligible_hw_free_trial`ã€`is_alfredcam_owner`
   - **æ–°å¢ API** (`GET "/entitlement/v1/attributes/subscription"`)ï¼šå–ä»£èˆŠæœ‰å…©æ”¯ APIï¼Œç”¨æ–¼è¨‚é–±è³¼è²·å®Œæˆå¾ŒåŒæ­¥

3. **Polling æ©Ÿåˆ¶**ï¼š
   - è¨‚é–±è³¼è²·å®Œæˆå¾Œï¼Œæ¯ 1 ç§’è¼ªè©¢ä¸€æ¬¡ï¼Œæœ€å¤š 5 æ¬¡
   - ç¢ºä¿è³¼è²·é«”é©—ä¿ç•™ 5 ç§’çš„ç­‰å¾…æ™‚é–“
   - æˆåŠŸæ¢ä»¶ï¼šAPI å›å‚³ `updated = true`

4. **User Properties Cache**ï¼š
   - æœ¬æ¬¡æ–°å¢ä¹‹åƒæ•¸çš†é ˆç¬¦åˆ Properties Cache ä¹‹è¡Œç‚ºï¼Œæœ‰è®Šæ›´æ‰æ‰“ä¸Šå»

5. **å‹æ…‹è½‰æ›**ï¼š
   - Client ç«¯çµ±ä¸€è½‰æ›æˆé…é©æ–¼ Third-Party ä¹‹å‹æ…‹
   - RC åªåƒ Stringï¼Œçµ±ä¸€ç”± Client åšå‹æ…‹è½‰æ›

---

## ğŸ¯ æ¸¬è©¦é‡é»èˆ‡é¢¨éšªè©•ä¼°

### å½±éŸ¿æ¨¡çµ„/åŠŸèƒ½
1. **ç¡¬é«”è£ç½®é…å°æµç¨‹ (Device Pairing)** - é«˜å½±éŸ¿
   - æ—¢æœ‰ API æ–°å¢ Response æ¬„ä½
   - å½±éŸ¿é…å°å®Œæˆå¾Œçš„ User Properties åŒæ­¥
   - æ¶‰åŠ `eligible_hw_free_trial`ã€`is_alfredcam_owner` å±¬æ€§

2. **è¨‚é–±è³¼è²·æµç¨‹ (Subscription Purchase)** - é«˜å½±éŸ¿
   - å®Œå…¨é‡æ§‹è¨‚é–±å±¬æ€§åŒæ­¥æ©Ÿåˆ¶
   - å¼•å…¥æ–°çš„è¼ªè©¢å¼ API èª¿ç”¨æµç¨‹
   - å½±éŸ¿æ‰€æœ‰è¨‚é–±ç›¸é—œçš„ User Properties åŒæ­¥

3. **User Properties åŒæ­¥æ©Ÿåˆ¶** - é«˜å½±éŸ¿
   - æ–°å¢ Client ç«¯åŒæ­¥é‚è¼¯
   - å½±éŸ¿ Amplitudeã€Appcuesã€RevenueCat çš„å±¬æ€§åŒæ­¥
   - æ¶‰åŠå‹æ…‹è½‰æ›å’Œ Cache æ©Ÿåˆ¶

4. **API æ•´åˆ** - ä¸­å½±éŸ¿
   - æ–°å¢ API ç«¯é»æ•´åˆ
   - å‘ä¸‹å…¼å®¹æ€§é©—è­‰
   - éŒ¯èª¤è™•ç†å’Œå›é€€æ©Ÿåˆ¶

### è¿´æ­¸é¢¨éšªå€
1. **ç¡¬é«”è£ç½®é…å°åŠŸèƒ½**ï¼š
   - ç¡¬é«”ç›¸æ©Ÿé…å°æµç¨‹ï¼ˆAC101/AC201/AC202ï¼‰
   - é…å°ç¢¼é©—è­‰
   - é…å°å®Œæˆå¾Œçš„ç‹€æ…‹æª¢æŸ¥

2. **è¨‚é–±è³¼è²·åŠŸèƒ½**ï¼š
   - Premium/Plus è¨‚é–±è³¼è²·æµç¨‹
   - è¨‚é–±ç‹€æ…‹æ›´æ–°
   - è¨‚é–±æ¬Šé™é©—è­‰

3. **User Properties åŒæ­¥**ï¼š
   - ç¾æœ‰çš„ Server Side åŒæ­¥æ©Ÿåˆ¶
   - Amplitudeã€Appcuesã€RevenueCat å±¬æ€§åŒæ­¥
   - Properties Cache æ©Ÿåˆ¶

4. **ç”¨æˆ¶æ¬Šé™èˆ‡è¨‚é–±**ï¼š
   - Premium ç”¨æˆ¶æ¬Šé™
   - Plus ç”¨æˆ¶æ¬Šé™
   - Free ç”¨æˆ¶æ¬Šé™

### å…·é«”æ¸¬è©¦å ´æ™¯å»ºè­°ï¼ˆå«é‚Šç·£æ¡ˆä¾‹ï¼‰
1. **ç¡¬é«”è£ç½®é…å°å®Œæˆå¾ŒåŒæ­¥**ï¼š
   - é…å°å®Œæˆå¾Œï¼Œ`eligible_hw_free_trial`ã€`is_alfredcam_owner` æ­£ç¢ºåŒæ­¥åˆ° Third-Party
   - å‘ä¸‹å…¼å®¹ï¼šèˆŠç‰ˆ Client ä»å¯ä½¿ç”¨æ—¢æœ‰æ¬„ä½
   - API Response æ–°å¢æ¬„ä½é©—è­‰

2. **è¨‚é–±è³¼è²·å®Œæˆå¾ŒåŒæ­¥**ï¼š
   - è¨‚é–±è³¼è²·å®Œæˆå¾Œï¼Œæ‰€æœ‰è¨‚é–±ç›¸é—œå±¬æ€§æ­£ç¢ºåŒæ­¥
   - Polling æ©Ÿåˆ¶ï¼šæ¯ 1 ç§’è¼ªè©¢ä¸€æ¬¡ï¼Œæœ€å¤š 5 æ¬¡
   - æˆåŠŸæ¢ä»¶ï¼š`updated = true`
   - å¤±æ•—æƒ…æ³ï¼šAPI Errorã€Timeout è™•ç†

3. **å‹æ…‹è½‰æ›æ¸¬è©¦**ï¼š
   - Boolean â†’ Stringï¼ˆRC éœ€è¦ï¼‰
   - String â†’ Stringï¼ˆAmplitudeã€Appcuesï¼‰
   - null å€¼è™•ç†ï¼šå¿½ç•¥ä¸æ›´æ–°
   - ç©ºå­—ä¸²è™•ç†ï¼šè¦–åŒçµ¦äºˆåƒæ•¸ï¼Œæ›´æ–°è‡³ Third-Party

4. **Properties Cache æ¸¬è©¦**ï¼š
   - æœ‰è®Šæ›´æ‰æ‰“ä¸Šå»
   - ç›¸åŒå€¼ä¸é‡è¤‡æ›´æ–°
   - Cache æ©Ÿåˆ¶æ­£å¸¸é‹ä½œ

5. **ç¶²è·¯ç•°å¸¸æ¸¬è©¦**ï¼š
   - å¼±ç¶²ç’°å¢ƒä¸‹çš„åŒæ­¥
   - ç¶²è·¯ä¸­æ–·å¾Œçš„æ¢å¾©
   - API å¤±æ•—æ™‚çš„å›é€€æ©Ÿåˆ¶

---

## ğŸ“ æ¸¬è©¦æ¡ˆä¾‹

## 1. åŠŸèƒ½èˆ‡æ¥­å‹™é‚è¼¯æ¸¬è©¦ (Functional & Business Logic)

### 1.1 ç¡¬é«”è£ç½®é…å°å®Œæˆå¾Œ User Properties åŒæ­¥æ¸¬è©¦
**æ¸¬è©¦ç›®æ¨™**ï¼šé©—è­‰ç¡¬é«”è£ç½®é…å°å®Œæˆå¾Œï¼Œ`eligible_hw_free_trial`ã€`is_alfredcam_owner` æ­£ç¢ºåŒæ­¥åˆ° Third-Party

**å‰ç½®æ¢ä»¶**ï¼š
- Android è¨­å‚™æº–å‚™é…å°ç¡¬é«”ç›¸æ©Ÿï¼ˆAC101/AC201/AC202ï¼‰
- æ¸¬è©¦å¸³è™Ÿç‚ºæ–°ç”¨æˆ¶æˆ–ç¬¦åˆç¡¬é«”å…è²»è©¦ç”¨è³‡æ ¼
- æº–å‚™ Third-Party å¾Œå°æŸ¥çœ‹å·¥å…·ï¼ˆAmplitudeã€Appcuesã€RevenueCatï¼‰

**æ¸¬è©¦æ­¥é©Ÿ**ï¼š
1. ä½¿ç”¨æ¸¬è©¦å¸³è™Ÿç™»å…¥ App
2. é€²å…¥ç¡¬é«”ç›¸æ©Ÿé…å°æµç¨‹
3. å®Œæˆç¡¬é«”ç›¸æ©Ÿé…å°ï¼ˆæƒæ QR Code æˆ–è¼¸å…¥é…å°ç¢¼ï¼‰
4. ç­‰å¾…é…å°å®Œæˆ
5. æª¢æŸ¥ API Responseï¼ˆ`GET "/v2.6/device/pairing/{code}/paired"`ï¼‰ï¼š
   - é©—è­‰ `eligible_hw_free_trial` æ¬„ä½å­˜åœ¨ä¸”å€¼æ­£ç¢º
   - é©—è­‰ `is_alfredcam_owner` æ¬„ä½å­˜åœ¨ä¸”å€¼ç‚º `true`
6. ç­‰å¾… User Properties åŒæ­¥ï¼ˆç´„ 1-2 ç§’ï¼‰
7. æª¢æŸ¥ Third-Party å¾Œå°ï¼š
   - Amplitudeï¼šé©—è­‰ `eligible_hw_free_trial`ã€`is_alfredcam_owner` å±¬æ€§
   - Appcuesï¼šé©—è­‰ `eligible_hw_free_trial`ã€`is_alfredcam_owner` å±¬æ€§
   - RevenueCatï¼šé©—è­‰ `eligible_hw_free_trial`ã€`is_alfredcam_owner` å±¬æ€§ï¼ˆå‹æ…‹ç‚º Stringï¼‰

**é æœŸçµæœ**ï¼š
- API Response åŒ…å« `eligible_hw_free_trial`ã€`is_alfredcam_owner` æ¬„ä½
- `is_alfredcam_owner` å€¼ç‚º `true`ï¼ˆBooleanï¼‰
- Third-Party å¾Œå°æ­£ç¢ºè¨˜éŒ„å±¬æ€§å€¼
- RevenueCat çš„ `is_alfredcam_owner` ç‚º String å‹æ…‹ï¼ˆ"true"ï¼‰
- åŒæ­¥æ™‚é–“ < 5 ç§’ï¼ˆå³æ™‚åŒæ­¥ï¼‰

---

### 1.2 è¨‚é–±è³¼è²·å®Œæˆå¾Œ User Properties åŒæ­¥æ¸¬è©¦ - Premium
**æ¸¬è©¦ç›®æ¨™**ï¼šé©—è­‰ Premium è¨‚é–±è³¼è²·å®Œæˆå¾Œï¼Œæ‰€æœ‰è¨‚é–±ç›¸é—œå±¬æ€§æ­£ç¢ºåŒæ­¥åˆ° Third-Party

**å‰ç½®æ¢ä»¶**ï¼š
- Android è¨­å‚™å·²å®‰è£ App
- æ¸¬è©¦å¸³è™Ÿç‚º Free ç”¨æˆ¶
- æº–å‚™ Premium è¨‚é–±è³¼è²·ï¼ˆæ¸¬è©¦ç’°å¢ƒæˆ–æ²™ç›’ç’°å¢ƒï¼‰
- æº–å‚™ Third-Party å¾Œå°æŸ¥çœ‹å·¥å…·

**æ¸¬è©¦æ­¥é©Ÿ**ï¼š
1. ä½¿ç”¨ Free å¸³è™Ÿç™»å…¥ App
2. é€²å…¥ Premium è¨‚é–±è³¼è²·é é¢
3. é¸æ“‡ Premium è¨‚é–±æ–¹æ¡ˆï¼ˆæœˆä»˜/å¹´ä»˜ï¼‰
4. å®Œæˆè¨‚é–±è³¼è²·æµç¨‹
5. è§€å¯Ÿ Polling æ©Ÿåˆ¶ï¼š
   - æ¯ 1 ç§’è¼ªè©¢ä¸€æ¬¡ APIï¼ˆ`GET "/entitlement/v1/attributes/subscription"`ï¼‰
   - æœ€å¤šè¼ªè©¢ 5 æ¬¡ï¼ˆç¸½å…± 5 ç§’ï¼‰
   - æˆåŠŸæ¢ä»¶ï¼šAPI å›å‚³ `updated = true`
6. æª¢æŸ¥ API Response åŒ…å«çš„å±¬æ€§ï¼š
   - `subscription_tier`ï¼ˆæ‡‰ç‚º "premium"ï¼‰
   - `subscription_cycle_iso`ï¼ˆå¦‚ "monthly" æˆ– "yearly"ï¼‰
   - `subscription_cycle_first`ï¼ˆæ‡‰ç‚º `true`ï¼Œé¦–æ¬¡è¨‚é–±ï¼‰
   - `subscription_channel`ï¼ˆè¨‚é–±æ¸ é“ï¼‰
   - `subscription_cancelled`ï¼ˆæ‡‰ç‚º `false`ï¼‰
   - `subscription_expiration_date`ï¼ˆè¨‚é–±åˆ°æœŸæ—¥ï¼‰
   - `subscription_product_id`ï¼ˆç”¢å“ IDï¼‰
7. ç­‰å¾… User Properties åŒæ­¥ï¼ˆç´„ 1-2 ç§’ï¼‰
8. æª¢æŸ¥ Third-Party å¾Œå°ï¼š
   - Amplitudeï¼šé©—è­‰æ‰€æœ‰è¨‚é–±å±¬æ€§
   - Appcuesï¼šé©—è­‰æ‰€æœ‰è¨‚é–±å±¬æ€§
   - RevenueCatï¼šé©—è­‰æ‰€æœ‰è¨‚é–±å±¬æ€§ï¼ˆBoolean è½‰ Stringï¼‰

**é æœŸçµæœ**ï¼š
- Polling æ©Ÿåˆ¶æ­£å¸¸é‹ä½œï¼ˆæ¯ 1 ç§’è¼ªè©¢ä¸€æ¬¡ï¼‰
- API å›å‚³ `updated = true` æ™‚åœæ­¢è¼ªè©¢
- æ‰€æœ‰è¨‚é–±å±¬æ€§æ­£ç¢ºåŒæ­¥åˆ° Third-Party
- RevenueCat çš„ Boolean å±¬æ€§è½‰æ›ç‚º Stringï¼ˆå¦‚ `"true"`ã€`"false"`ï¼‰
- åŒæ­¥æ™‚é–“ < 10 ç§’ï¼ˆåŒ…å« Polling æ™‚é–“ï¼‰

---

### 1.3 è¨‚é–±è³¼è²·å®Œæˆå¾Œ User Properties åŒæ­¥æ¸¬è©¦ - Plus
**æ¸¬è©¦ç›®æ¨™**ï¼šé©—è­‰ Plus è¨‚é–±è³¼è²·å®Œæˆå¾Œï¼Œæ‰€æœ‰è¨‚é–±ç›¸é—œå±¬æ€§æ­£ç¢ºåŒæ­¥åˆ° Third-Party

**å‰ç½®æ¢ä»¶**ï¼š
- Android è¨­å‚™å·²å®‰è£ App
- æ¸¬è©¦å¸³è™Ÿç‚º Free ç”¨æˆ¶
- æº–å‚™ Plus è¨‚é–±è³¼è²·ï¼ˆæ¸¬è©¦ç’°å¢ƒæˆ–æ²™ç›’ç’°å¢ƒï¼‰

**æ¸¬è©¦æ­¥é©Ÿ**ï¼š
1. ä½¿ç”¨ Free å¸³è™Ÿç™»å…¥ App
2. é€²å…¥ Plus è¨‚é–±è³¼è²·é é¢
3. é¸æ“‡ Plus è¨‚é–±æ–¹æ¡ˆï¼ˆæœˆä»˜/å¹´ä»˜ï¼‰
4. å®Œæˆè¨‚é–±è³¼è²·æµç¨‹
5. è§€å¯Ÿ Polling æ©Ÿåˆ¶é‹ä½œ
6. æª¢æŸ¥ API Response åŒ…å«çš„å±¬æ€§ï¼š
   - `subscription_tier`ï¼ˆæ‡‰ç‚º "plus"ï¼‰
   - å…¶ä»–è¨‚é–±å±¬æ€§
7. æª¢æŸ¥ Third-Party å¾Œå°å±¬æ€§åŒæ­¥

**é æœŸçµæœ**ï¼š
- `subscription_tier` ç‚º "plus"
- æ‰€æœ‰è¨‚é–±å±¬æ€§æ­£ç¢ºåŒæ­¥
- åŒæ­¥æ™‚é–“ < 10 ç§’

---

### 1.4 è¨‚é–±çºŒè¨‚å ´æ™¯æ¸¬è©¦
**æ¸¬è©¦ç›®æ¨™**ï¼šé©—è­‰è¨‚é–±çºŒè¨‚æ™‚ï¼Œ`subscription_cycle_first` æ­£ç¢ºåŒæ­¥ç‚º `false`

**å‰ç½®æ¢ä»¶**ï¼š
- æ¸¬è©¦å¸³è™Ÿå·²æœ‰ Premium æˆ– Plus è¨‚é–±
- è¨‚é–±å³å°‡åˆ°æœŸæˆ–å·²åˆ°æœŸ
- æº–å‚™çºŒè¨‚æµç¨‹

**æ¸¬è©¦æ­¥é©Ÿ**ï¼š
1. ä½¿ç”¨å·²æœ‰è¨‚é–±çš„å¸³è™Ÿç™»å…¥ App
2. é€²å…¥è¨‚é–±çºŒè¨‚æµç¨‹
3. å®ŒæˆçºŒè¨‚è³¼è²·
4. è§€å¯Ÿ Polling æ©Ÿåˆ¶é‹ä½œ
5. æª¢æŸ¥ API Responseï¼š
   - `subscription_cycle_first` æ‡‰ç‚º `false`ï¼ˆéé¦–æ¬¡è¨‚é–±ï¼‰
   - `subscription_tier` ä¿æŒä¸è®Š
   - `subscription_expiration_date` æ›´æ–°ç‚ºæ–°çš„åˆ°æœŸæ—¥
6. æª¢æŸ¥ Third-Party å¾Œå°å±¬æ€§åŒæ­¥

**é æœŸçµæœ**ï¼š
- `subscription_cycle_first` ç‚º `false`
- å…¶ä»–è¨‚é–±å±¬æ€§æ­£ç¢ºæ›´æ–°
- å±¬æ€§æ­£ç¢ºåŒæ­¥åˆ° Third-Party

---

### 1.5 è¨‚é–±å–æ¶ˆå ´æ™¯æ¸¬è©¦
**æ¸¬è©¦ç›®æ¨™**ï¼šé©—è­‰è¨‚é–±å–æ¶ˆæ™‚ï¼Œ`subscription_cancelled` æ­£ç¢ºåŒæ­¥ç‚º `true`

**å‰ç½®æ¢ä»¶**ï¼š
- æ¸¬è©¦å¸³è™Ÿå·²æœ‰ Premium æˆ– Plus è¨‚é–±

**æ¸¬è©¦æ­¥é©Ÿ**ï¼š
1. ä½¿ç”¨å·²æœ‰è¨‚é–±çš„å¸³è™Ÿç™»å…¥ App
2. é€²å…¥è¨‚é–±ç®¡ç†é é¢
3. åŸ·è¡Œè¨‚é–±å–æ¶ˆæ“ä½œ
4. ç­‰å¾…è¨‚é–±ç‹€æ…‹æ›´æ–°
5. æª¢æŸ¥ API Responseï¼š
   - `subscription_cancelled` æ‡‰ç‚º `true`
6. æª¢æŸ¥ Third-Party å¾Œå°å±¬æ€§åŒæ­¥

**é æœŸçµæœ**ï¼š
- `subscription_cancelled` ç‚º `true`
- å±¬æ€§æ­£ç¢ºåŒæ­¥åˆ° Third-Party

---

### 1.6 Polling æ©Ÿåˆ¶ - æˆåŠŸå ´æ™¯æ¸¬è©¦
**æ¸¬è©¦ç›®æ¨™**ï¼šé©—è­‰ Polling æ©Ÿåˆ¶åœ¨ API å›å‚³ `updated = true` æ™‚æ­£ç¢ºåœæ­¢

**å‰ç½®æ¢ä»¶**ï¼š
- æº–å‚™è¨‚é–±è³¼è²·æµç¨‹
- æ¨¡æ“¬ API åœ¨ç¬¬ä¸€æ¬¡è¼ªè©¢æ™‚å›å‚³ `updated = true`

**æ¸¬è©¦æ­¥é©Ÿ**ï¼š
1. å®Œæˆè¨‚é–±è³¼è²·æµç¨‹
2. è§€å¯Ÿ Polling æ©Ÿåˆ¶ï¼š
   - ç¬¬ä¸€æ¬¡è¼ªè©¢ï¼ˆ0 ç§’ï¼‰ï¼šAPI å›å‚³ `updated = true`
   - é©—è­‰æ˜¯å¦ç«‹å³åœæ­¢è¼ªè©¢ï¼ˆä¸å†é€²è¡Œå¾ŒçºŒè¼ªè©¢ï¼‰
3. æª¢æŸ¥ Third-Party å¾Œå°å±¬æ€§åŒæ­¥

**é æœŸçµæœ**ï¼š
- ç¬¬ä¸€æ¬¡è¼ªè©¢æˆåŠŸå¾Œç«‹å³åœæ­¢
- ä¸å†é€²è¡Œå¾ŒçºŒè¼ªè©¢
- å±¬æ€§æ­£ç¢ºåŒæ­¥
- ç¸½ç­‰å¾…æ™‚é–“ < 2 ç§’

---

### 1.7 Polling æ©Ÿåˆ¶ - æœ€å¤§é‡è©¦æ¬¡æ•¸æ¸¬è©¦
**æ¸¬è©¦ç›®æ¨™**ï¼šé©—è­‰ Polling æ©Ÿåˆ¶åœ¨é”åˆ°æœ€å¤§é‡è©¦æ¬¡æ•¸ï¼ˆ5 æ¬¡ï¼‰æ™‚æ­£ç¢ºåœæ­¢

**å‰ç½®æ¢ä»¶**ï¼š
- æº–å‚™è¨‚é–±è³¼è²·æµç¨‹
- æ¨¡æ“¬ API åœ¨ 5 æ¬¡è¼ªè©¢å…§éƒ½å›å‚³ `updated = false`

**æ¸¬è©¦æ­¥é©Ÿ**ï¼š
1. å®Œæˆè¨‚é–±è³¼è²·æµç¨‹
2. è§€å¯Ÿ Polling æ©Ÿåˆ¶ï¼š
   - ç¬¬ä¸€æ¬¡è¼ªè©¢ï¼ˆ0 ç§’ï¼‰ï¼šAPI å›å‚³ `updated = false`
   - ç¬¬äºŒæ¬¡è¼ªè©¢ï¼ˆ1 ç§’ï¼‰ï¼šAPI å›å‚³ `updated = false`
   - ç¬¬ä¸‰æ¬¡è¼ªè©¢ï¼ˆ2 ç§’ï¼‰ï¼šAPI å›å‚³ `updated = false`
   - ç¬¬å››æ¬¡è¼ªè©¢ï¼ˆ3 ç§’ï¼‰ï¼šAPI å›å‚³ `updated = false`
   - ç¬¬äº”æ¬¡è¼ªè©¢ï¼ˆ4 ç§’ï¼‰ï¼šAPI å›å‚³ `updated = false`
   - é©—è­‰æ˜¯å¦åœ¨ 5 æ¬¡å¾Œåœæ­¢è¼ªè©¢
3. æª¢æŸ¥ Third-Party å¾Œå°å±¬æ€§åŒæ­¥ï¼ˆå¯èƒ½æœªåŒæ­¥æˆ–ä½¿ç”¨å›é€€æ©Ÿåˆ¶ï¼‰

**é æœŸçµæœ**ï¼š
- æº–ç¢ºåŸ·è¡Œ 5 æ¬¡è¼ªè©¢
- æ¯æ¬¡è¼ªè©¢é–“éš”ç´„ 1 ç§’
- 5 æ¬¡å¾Œåœæ­¢è¼ªè©¢
- ç¸½ç­‰å¾…æ™‚é–“ç´„ 5 ç§’
- æœ‰é©ç•¶çš„éŒ¯èª¤è™•ç†æˆ–å›é€€æ©Ÿåˆ¶

---

### 1.8 å‹æ…‹è½‰æ›æ¸¬è©¦ - Boolean è½‰ Stringï¼ˆRevenueCatï¼‰
**æ¸¬è©¦ç›®æ¨™**ï¼šé©—è­‰ Boolean å‹æ…‹å±¬æ€§æ­£ç¢ºè½‰æ›ç‚º String å¾ŒåŒæ­¥åˆ° RevenueCat

**å‰ç½®æ¢ä»¶**ï¼š
- æº–å‚™ç¡¬é«”ç›¸æ©Ÿé…å°æˆ–è¨‚é–±è³¼è²·æµç¨‹
- æº–å‚™ RevenueCat å¾Œå°æŸ¥çœ‹å·¥å…·

**æ¸¬è©¦æ­¥é©Ÿ**ï¼š
1. å®Œæˆç¡¬é«”ç›¸æ©Ÿé…å°æˆ–è¨‚é–±è³¼è²·
2. æª¢æŸ¥ API Response ä¸­çš„ Boolean å±¬æ€§ï¼š
   - `is_alfredcam_owner`ï¼ˆBooleanï¼‰
   - `subscription_cycle_first`ï¼ˆBooleanï¼‰
   - `subscription_cancelled`ï¼ˆBooleanï¼‰
3. æª¢æŸ¥ RevenueCat å¾Œå°ï¼š
   - é©—è­‰ `is_alfredcam_owner` ç‚º String å‹æ…‹ï¼ˆ"true" æˆ– "false"ï¼‰
   - é©—è­‰ `subscription_cycle_first` ç‚º String å‹æ…‹ï¼ˆ"true" æˆ– "false"ï¼‰
   - é©—è­‰ `subscription_cancelled` ç‚º String å‹æ…‹ï¼ˆ"true" æˆ– "false"ï¼‰
4. æª¢æŸ¥ Amplitudeã€Appcues å¾Œå°ï¼š
   - é©—è­‰å±¬æ€§ä¿æŒ Boolean å‹æ…‹

**é æœŸçµæœ**ï¼š
- RevenueCat çš„ Boolean å±¬æ€§è½‰æ›ç‚º String
- Amplitudeã€Appcues çš„ Boolean å±¬æ€§ä¿æŒ Boolean
- å‹æ…‹è½‰æ›æ­£ç¢ºç„¡èª¤

---

### 1.9 null å€¼è™•ç†æ¸¬è©¦
**æ¸¬è©¦ç›®æ¨™**ï¼šé©—è­‰ API Response ä¸­ null å€¼å±¬æ€§ä¸æœƒåŒæ­¥åˆ° Third-Party

**å‰ç½®æ¢ä»¶**ï¼š
- æº–å‚™æ¸¬è©¦å ´æ™¯ï¼ˆå¦‚ï¼šç”¨æˆ¶æ²’æœ‰è¨‚é–±æ™‚ï¼‰

**æ¸¬è©¦æ­¥é©Ÿ**ï¼š
1. ä½¿ç”¨æ²’æœ‰è¨‚é–±çš„å¸³è™Ÿç™»å…¥ App
2. è§¸ç™¼ User Properties åŒæ­¥ï¼ˆå¦‚ï¼šé…å°ç¡¬é«”ç›¸æ©Ÿï¼‰
3. æª¢æŸ¥ API Responseï¼š
   - æŸäº›è¨‚é–±å±¬æ€§å¯èƒ½ç‚º `null`ï¼ˆå¦‚ `subscription_tier`ï¼‰
4. æª¢æŸ¥ Third-Party å¾Œå°ï¼š
   - é©—è­‰ `null` å€¼å±¬æ€§ä¸æœƒæ›´æ–°åˆ° Third-Party
   - é©—è­‰ç¾æœ‰å±¬æ€§å€¼ä¿æŒä¸è®Š

**é æœŸçµæœ**ï¼š
- `null` å€¼å±¬æ€§è¢«å¿½ç•¥ï¼Œä¸æ›´æ–°åˆ° Third-Party
- ç¾æœ‰å±¬æ€§å€¼ä¿æŒä¸è®Š
- ç„¡éŒ¯èª¤æˆ–ç•°å¸¸

---

### 1.10 ç©ºå­—ä¸²è™•ç†æ¸¬è©¦
**æ¸¬è©¦ç›®æ¨™**ï¼šé©—è­‰ API Response ä¸­ç©ºå­—ä¸²å±¬æ€§æœƒåŒæ­¥åˆ° Third-Party

**å‰ç½®æ¢ä»¶**ï¼š
- æº–å‚™æ¸¬è©¦å ´æ™¯ï¼ˆæ¨¡æ“¬ API å›å‚³ç©ºå­—ä¸²ï¼‰

**æ¸¬è©¦æ­¥é©Ÿ**ï¼š
1. è§¸ç™¼ User Properties åŒæ­¥
2. æª¢æŸ¥ API Responseï¼š
   - æŸäº›å±¬æ€§å¯èƒ½ç‚ºç©ºå­—ä¸² `""`ï¼ˆå¦‚ `subscription_tier = ""`ï¼‰
3. æª¢æŸ¥ Third-Party å¾Œå°ï¼š
   - é©—è­‰ç©ºå­—ä¸²å±¬æ€§æœƒæ›´æ–°åˆ° Third-Partyï¼ˆè¦–åŒçµ¦äºˆåƒæ•¸ï¼‰

**é æœŸçµæœ**ï¼š
- ç©ºå­—ä¸²å±¬æ€§æœƒæ›´æ–°åˆ° Third-Party
- ç©ºå­—ä¸²è¦–åŒçµ¦äºˆåƒæ•¸ï¼Œä¸æ˜¯å¿½ç•¥

---

### 1.11 Properties Cache æ©Ÿåˆ¶æ¸¬è©¦
**æ¸¬è©¦ç›®æ¨™**ï¼šé©—è­‰ Properties Cache æ©Ÿåˆ¶æ­£å¸¸é‹ä½œï¼Œæœ‰è®Šæ›´æ‰æ‰“ä¸Šå»

**å‰ç½®æ¢ä»¶**ï¼š
- æº–å‚™è¨‚é–±è³¼è²·æˆ–é…å°æµç¨‹

**æ¸¬è©¦æ­¥é©Ÿ**ï¼š
1. å®Œæˆç¬¬ä¸€æ¬¡è¨‚é–±è³¼è²·æˆ–é…å°
2. æª¢æŸ¥ Third-Party å¾Œå°å±¬æ€§åŒæ­¥
3. å†æ¬¡è§¸ç™¼ç›¸åŒçš„æ“ä½œï¼ˆå¦‚åŒæ¨£çš„è¨‚é–±è³¼è²·ï¼‰
4. æª¢æŸ¥ Third-Party å¾Œå°ï¼š
   - é©—è­‰ç›¸åŒå€¼çš„å±¬æ€§ä¸æœƒé‡è¤‡æ›´æ–°
   - é©—è­‰åªæœ‰è®Šæ›´çš„å±¬æ€§æ‰æœƒæ›´æ–°

**é æœŸçµæœ**ï¼š
- Properties Cache æ©Ÿåˆ¶æ­£å¸¸é‹ä½œ
- ç›¸åŒå€¼ä¸é‡è¤‡æ›´æ–°
- åªæœ‰è®Šæ›´çš„å±¬æ€§æ‰æœƒæ›´æ–°
- æ¸›å°‘ä¸å¿…è¦çš„ API èª¿ç”¨

---

### 1.12 å‘ä¸‹å…¼å®¹æ€§æ¸¬è©¦ - èˆŠç‰ˆ API Response
**æ¸¬è©¦ç›®æ¨™**ï¼šé©—è­‰èˆŠç‰ˆ Client ä»å¯ä½¿ç”¨æ—¢æœ‰ API Response æ¬„ä½

**å‰ç½®æ¢ä»¶**ï¼š
- æº–å‚™èˆŠç‰ˆ Appï¼ˆæœªæ›´æ–° User Properties åŒæ­¥æ©Ÿåˆ¶ï¼‰

**æ¸¬è©¦æ­¥é©Ÿ**ï¼š
1. ä½¿ç”¨èˆŠç‰ˆ App å®Œæˆç¡¬é«”ç›¸æ©Ÿé…å°
2. æª¢æŸ¥ API Responseï¼š
   - é©—è­‰æ—¢æœ‰æ¬„ä½ä»ç„¶å­˜åœ¨
   - é©—è­‰æ–°å¢æ¬„ä½ä¸å½±éŸ¿èˆŠç‰ˆ Client
3. é©—è­‰èˆŠç‰ˆ App åŠŸèƒ½æ­£å¸¸é‹ä½œ

**é æœŸçµæœ**ï¼š
- èˆŠç‰ˆ Client ä»å¯ä½¿ç”¨æ—¢æœ‰æ¬„ä½
- æ–°å¢æ¬„ä½ä¸å½±éŸ¿èˆŠç‰ˆ Client
- å‘ä¸‹å…¼å®¹æ€§æ­£å¸¸

---

## 2. ç©©å®šæ€§èˆ‡å¯é æ€§æ¸¬è©¦ (Stability & Reliability)

### 2.1 ç¶²è·¯ç•°å¸¸ - API å¤±æ•—è™•ç†æ¸¬è©¦
**æ¸¬è©¦ç›®æ¨™**ï¼šé©—è­‰ API å¤±æ•—æ™‚çš„å›é€€æ©Ÿåˆ¶å’ŒéŒ¯èª¤è™•ç†

**å‰ç½®æ¢ä»¶**ï¼š
- æº–å‚™è¨‚é–±è³¼è²·æµç¨‹
- æ¨¡æ“¬ API å¤±æ•—ï¼ˆç¶²è·¯ä¸­æ–·ã€API éŒ¯èª¤ç­‰ï¼‰

**æ¸¬è©¦æ­¥é©Ÿ**ï¼š
1. å®Œæˆè¨‚é–±è³¼è²·æµç¨‹
2. åœ¨ Polling éç¨‹ä¸­æ¨¡æ“¬ API å¤±æ•—ï¼š
   - ç¶²è·¯ä¸­æ–·
   - API è¿”å›éŒ¯èª¤ï¼ˆå¦‚ 500ã€503ï¼‰
   - API Timeout
3. è§€å¯Ÿ Polling æ©Ÿåˆ¶ï¼š
   - é©—è­‰æ˜¯å¦ç¹¼çºŒé‡è©¦ï¼ˆæœ€å¤š 5 æ¬¡ï¼‰
   - é©—è­‰éŒ¯èª¤è™•ç†é‚è¼¯
4. æª¢æŸ¥æ˜¯å¦æœ‰å›é€€æ©Ÿåˆ¶ï¼ˆå¦‚ï¼šä½¿ç”¨èˆŠç‰ˆ RC å±¬æ€§åŒæ­¥ï¼‰

**é æœŸçµæœ**ï¼š
- API å¤±æ•—æ™‚ç¹¼çºŒé‡è©¦ï¼ˆæœ€å¤š 5 æ¬¡ï¼‰
- æœ‰é©ç•¶çš„éŒ¯èª¤è™•ç†
- æœ‰å›é€€æ©Ÿåˆ¶ï¼ˆå¦‚ï¼šä½¿ç”¨èˆŠç‰ˆåŒæ­¥æ©Ÿåˆ¶ï¼‰
- App ä¸æœƒå´©æ½°æˆ–ç•°å¸¸

---

### 2.2 å¼±ç¶²ç’°å¢ƒæ¸¬è©¦
**æ¸¬è©¦ç›®æ¨™**ï¼šé©—è­‰å¼±ç¶²ç’°å¢ƒä¸‹ User Properties åŒæ­¥çš„ç©©å®šæ€§

**å‰ç½®æ¢ä»¶**ï¼š
- æº–å‚™å¼±ç¶²ç’°å¢ƒï¼ˆå¦‚ï¼šç¶²è·¯é™é€Ÿã€ä¸ç©©å®šé€£ç·šï¼‰

**æ¸¬è©¦æ­¥é©Ÿ**ï¼š
1. è¨­å®šå¼±ç¶²ç’°å¢ƒï¼ˆç¶²è·¯é™é€Ÿè‡³ 3G é€Ÿåº¦ï¼‰
2. å®Œæˆç¡¬é«”ç›¸æ©Ÿé…å°æˆ–è¨‚é–±è³¼è²·
3. è§€å¯Ÿ Polling æ©Ÿåˆ¶ï¼š
   - é©—è­‰åœ¨å¼±ç¶²ç’°å¢ƒä¸‹æ˜¯å¦æ­£å¸¸é‹ä½œ
   - é©—è­‰è¼ªè©¢é–“éš”æ˜¯å¦æ­£ç¢ºï¼ˆç´„ 1 ç§’ï¼‰
4. æª¢æŸ¥ Third-Party å¾Œå°å±¬æ€§åŒæ­¥

**é æœŸçµæœ**ï¼š
- å¼±ç¶²ç’°å¢ƒä¸‹ Polling æ©Ÿåˆ¶æ­£å¸¸é‹ä½œ
- å±¬æ€§æœ€çµ‚èƒ½æ­£ç¢ºåŒæ­¥ï¼ˆå¯èƒ½éœ€è¦æ›´é•·æ™‚é–“ï¼‰
- ç„¡å´©æ½°æˆ–ç•°å¸¸

---

### 2.3 ç¶²è·¯ä¸­æ–·æ¢å¾©æ¸¬è©¦
**æ¸¬è©¦ç›®æ¨™**ï¼šé©—è­‰ç¶²è·¯ä¸­æ–·æ¢å¾©å¾Œ User Properties åŒæ­¥çš„æ¢å¾©èƒ½åŠ›

**å‰ç½®æ¢ä»¶**ï¼š
- æº–å‚™è¨‚é–±è³¼è²·æµç¨‹

**æ¸¬è©¦æ­¥é©Ÿ**ï¼š
1. å®Œæˆè¨‚é–±è³¼è²·æµç¨‹
2. åœ¨ Polling éç¨‹ä¸­ä¸­æ–·ç¶²è·¯
3. ç­‰å¾… 3 ç§’
4. æ¢å¾©ç¶²è·¯é€£ç·š
5. è§€å¯Ÿ Polling æ©Ÿåˆ¶ï¼š
   - é©—è­‰æ˜¯å¦ç¹¼çºŒé‡è©¦
   - é©—è­‰æ˜¯å¦èƒ½åœ¨å‰©é¤˜æ¬¡æ•¸å…§æˆåŠŸ
6. æª¢æŸ¥ Third-Party å¾Œå°å±¬æ€§åŒæ­¥

**é æœŸçµæœ**ï¼š
- ç¶²è·¯æ¢å¾©å¾Œç¹¼çºŒé‡è©¦
- èƒ½åœ¨å‰©é¤˜æ¬¡æ•¸å…§æˆåŠŸåŒæ­¥
- å±¬æ€§æœ€çµ‚æ­£ç¢ºåŒæ­¥

---

### 2.4 é•·æ™‚é–“é€£ç·šç©©å®šæ€§æ¸¬è©¦
**æ¸¬è©¦ç›®æ¨™**ï¼šé©—è­‰é•·æ™‚é–“ä½¿ç”¨ App å¾Œ User Properties åŒæ­¥æ©Ÿåˆ¶ä»æ­£å¸¸é‹ä½œ

**å‰ç½®æ¢ä»¶**ï¼š
- æº–å‚™æ¸¬è©¦å¸³è™Ÿ

**æ¸¬è©¦æ­¥é©Ÿ**ï¼š
1. ä½¿ç”¨æ¸¬è©¦å¸³è™Ÿç™»å…¥ App
2. æ­£å¸¸ä½¿ç”¨ App 30 åˆ†é˜ä»¥ä¸Š
3. åŸ·è¡Œå¤šæ¬¡æ“ä½œï¼š
   - é…å°ç¡¬é«”ç›¸æ©Ÿ
   - è³¼è²·è¨‚é–±
   - å–æ¶ˆè¨‚é–±
4. æ¯æ¬¡æ“ä½œå¾Œæª¢æŸ¥ Third-Party å¾Œå°å±¬æ€§åŒæ­¥
5. æª¢æŸ¥ App è¨˜æ†¶é«”ä½¿ç”¨å’Œæ•ˆèƒ½

**é æœŸçµæœ**ï¼š
- é•·æ™‚é–“ä½¿ç”¨å¾ŒåŒæ­¥æ©Ÿåˆ¶ä»æ­£å¸¸é‹ä½œ
- ç„¡è¨˜æ†¶é«”æ´©æ¼
- ç„¡æ•ˆèƒ½ä¸‹é™
- å±¬æ€§åŒæ­¥æº–ç¢ºæ€§ä¸è®Š

---

### 2.5 ä¸¦ç™¼æ“ä½œæ¸¬è©¦
**æ¸¬è©¦ç›®æ¨™**ï¼šé©—è­‰åŒæ™‚é€²è¡Œå¤šå€‹æ“ä½œæ™‚ User Properties åŒæ­¥çš„æ­£ç¢ºæ€§

**å‰ç½®æ¢ä»¶**ï¼š
- æº–å‚™å¤šå€‹æ¸¬è©¦å¸³è™Ÿ

**æ¸¬è©¦æ­¥é©Ÿ**ï¼š
1. åŒæ™‚ä½¿ç”¨å¤šå€‹å¸³è™Ÿç™»å…¥ App
2. åŒæ™‚åŸ·è¡Œå¤šå€‹æ“ä½œï¼š
   - å¸³è™Ÿ Aï¼šé…å°ç¡¬é«”ç›¸æ©Ÿ
   - å¸³è™Ÿ Bï¼šè³¼è²· Premium è¨‚é–±
   - å¸³è™Ÿ Cï¼šè³¼è²· Plus è¨‚é–±
3. è§€å¯Ÿæ¯å€‹æ“ä½œçš„ Polling æ©Ÿåˆ¶
4. æª¢æŸ¥ Third-Party å¾Œå°ï¼š
   - é©—è­‰æ¯å€‹å¸³è™Ÿçš„å±¬æ€§æ­£ç¢ºåŒæ­¥
   - é©—è­‰å±¬æ€§ä¸æœƒæ··æ·†

**é æœŸçµæœ**ï¼š
- ä¸¦ç™¼æ“ä½œä¸‹åŒæ­¥æ©Ÿåˆ¶æ­£å¸¸é‹ä½œ
- æ¯å€‹å¸³è™Ÿçš„å±¬æ€§æ­£ç¢ºåŒæ­¥
- å±¬æ€§ä¸æœƒæ··æ·†
- ç„¡ç«¶æ…‹æ¢ä»¶æˆ–è³‡æ–™éŒ¯èª¤

---

## 3. ä½¿ç”¨è€…é«”é©—æ¸¬è©¦ (User Experience)

### 3.1 è¨‚é–±è³¼è²·æµç¨‹é«”é©—æ¸¬è©¦
**æ¸¬è©¦ç›®æ¨™**ï¼šé©—è­‰è¨‚é–±è³¼è²·æµç¨‹çš„ç”¨æˆ¶é«”é©—ä¸å— Polling æ©Ÿåˆ¶å½±éŸ¿

**å‰ç½®æ¢ä»¶**ï¼š
- æº–å‚™è¨‚é–±è³¼è²·æµç¨‹

**æ¸¬è©¦æ­¥é©Ÿ**ï¼š
1. é€²å…¥ Premium è¨‚é–±è³¼è²·é é¢
2. é¸æ“‡è¨‚é–±æ–¹æ¡ˆ
3. å®Œæˆè¨‚é–±è³¼è²·æµç¨‹
4. è§€å¯Ÿç”¨æˆ¶é«”é©—ï¼š
   - è³¼è²·å®Œæˆå¾Œæ˜¯å¦æœ‰æ˜é¡¯å»¶é²
   - æ˜¯å¦æœ‰è¼‰å…¥æŒ‡ç¤ºå™¨
   - ç”¨æˆ¶æ˜¯å¦èƒ½æ­£å¸¸ä½¿ç”¨ Premium åŠŸèƒ½
5. æª¢æŸ¥ Third-Party å¾Œå°å±¬æ€§åŒæ­¥

**é æœŸçµæœ**ï¼š
- è³¼è²·æµç¨‹é †æš¢ï¼Œç„¡æ˜é¡¯å»¶é²
- ç”¨æˆ¶èƒ½ç«‹å³ä½¿ç”¨ Premium åŠŸèƒ½ï¼ˆå³ä½¿å±¬æ€§ä»åœ¨åŒæ­¥ä¸­ï¼‰
- Polling æ©Ÿåˆ¶ä¸å½±éŸ¿ç”¨æˆ¶é«”é©—
- ç¸½ç­‰å¾…æ™‚é–“æ§åˆ¶åœ¨ 5 ç§’å…§

---

### 3.2 é…å°æµç¨‹é«”é©—æ¸¬è©¦
**æ¸¬è©¦ç›®æ¨™**ï¼šé©—è­‰ç¡¬é«”ç›¸æ©Ÿé…å°æµç¨‹çš„ç”¨æˆ¶é«”é©—ä¸å—æ–°å¢æ¬„ä½å½±éŸ¿

**å‰ç½®æ¢ä»¶**ï¼š
- æº–å‚™ç¡¬é«”ç›¸æ©Ÿé…å°æµç¨‹

**æ¸¬è©¦æ­¥é©Ÿ**ï¼š
1. é€²å…¥ç¡¬é«”ç›¸æ©Ÿé…å°æµç¨‹
2. æƒæ QR Code æˆ–è¼¸å…¥é…å°ç¢¼
3. å®Œæˆé…å°æµç¨‹
4. è§€å¯Ÿç”¨æˆ¶é«”é©—ï¼š
   - é…å°å®Œæˆå¾Œæ˜¯å¦æœ‰æ˜é¡¯å»¶é²
   - æ˜¯å¦èƒ½ç«‹å³ä½¿ç”¨ç›¸æ©ŸåŠŸèƒ½
5. æª¢æŸ¥ Third-Party å¾Œå°å±¬æ€§åŒæ­¥

**é æœŸçµæœ**ï¼š
- é…å°æµç¨‹é †æš¢ï¼Œç„¡æ˜é¡¯å»¶é²
- ç”¨æˆ¶èƒ½ç«‹å³ä½¿ç”¨ç›¸æ©ŸåŠŸèƒ½
- æ–°å¢æ¬„ä½ä¸å½±éŸ¿ç”¨æˆ¶é«”é©—

---

## 4. æ•ˆèƒ½æ¸¬è©¦ (Performance)

### 4.1 Polling æ©Ÿåˆ¶æ•ˆèƒ½æ¸¬è©¦
**æ¸¬è©¦ç›®æ¨™**ï¼šé©—è­‰ Polling æ©Ÿåˆ¶å° App æ•ˆèƒ½å’Œé›»æ± æ¶ˆè€—çš„å½±éŸ¿

**å‰ç½®æ¢ä»¶**ï¼š
- æº–å‚™è¨‚é–±è³¼è²·æµç¨‹
- æº–å‚™æ•ˆèƒ½ç›£æ§å·¥å…·

**æ¸¬è©¦æ­¥é©Ÿ**ï¼š
1. å•Ÿå‹•æ•ˆèƒ½ç›£æ§å·¥å…·
2. å®Œæˆè¨‚é–±è³¼è²·æµç¨‹
3. ç›£æ§ Polling æ©Ÿåˆ¶æœŸé–“ï¼š
   - CPU ä½¿ç”¨ç‡
   - è¨˜æ†¶é«”ä½¿ç”¨
   - ç¶²è·¯æµé‡
   - é›»æ± æ¶ˆè€—
4. åˆ†ææ•ˆèƒ½å½±éŸ¿

**é æœŸçµæœ**ï¼š
- CPU ä½¿ç”¨ç‡å¢åŠ  < 5%ï¼ˆåƒè€ƒå€¼ï¼‰
- è¨˜æ†¶é«”ä½¿ç”¨å¢åŠ  < 5MBï¼ˆåƒè€ƒå€¼ï¼‰
- ç¶²è·¯æµé‡ï¼šæœ€å¤š 5 æ¬¡ API èª¿ç”¨
- é›»æ± æ¶ˆè€—å¢åŠ åœ¨åˆç†ç¯„åœå…§
- ç¸½å½±éŸ¿æ™‚é–“ < 5 ç§’

---

### 4.2 å±¬æ€§åŒæ­¥å»¶é²æ¸¬è©¦
**æ¸¬è©¦ç›®æ¨™**ï¼šé©—è­‰å±¬æ€§åŒæ­¥çš„å»¶é²æ™‚é–“ç¬¦åˆé æœŸï¼ˆå³æ™‚åŒæ­¥ï¼‰

**å‰ç½®æ¢ä»¶**ï¼š
- æº–å‚™é…å°æˆ–è¨‚é–±æµç¨‹
- æº–å‚™æ™‚é–“æ¸¬é‡å·¥å…·

**æ¸¬è©¦æ­¥é©Ÿ**ï¼š
1. å®Œæˆç¡¬é«”ç›¸æ©Ÿé…å°æˆ–è¨‚é–±è³¼è²·
2. è¨˜éŒ„æ“ä½œå®Œæˆæ™‚é–“ï¼ˆT1ï¼‰
3. æª¢æŸ¥ Third-Party å¾Œå°ï¼Œè¨˜éŒ„å±¬æ€§åŒæ­¥æ™‚é–“ï¼ˆT2ï¼‰
4. è¨ˆç®—å»¶é²æ™‚é–“ï¼šT2 - T1
5. é‡è¤‡æ¸¬è©¦ 10 æ¬¡ï¼Œè¨ˆç®—å¹³å‡å»¶é²æ™‚é–“

**é æœŸçµæœ**ï¼š
- é…å°å®Œæˆå¾ŒåŒæ­¥å»¶é² < 5 ç§’
- è¨‚é–±è³¼è²·å®Œæˆå¾ŒåŒæ­¥å»¶é² < 10 ç§’ï¼ˆåŒ…å« Polling æ™‚é–“ï¼‰
- å¹³å‡å»¶é²æ™‚é–“ç¬¦åˆé æœŸ
- ç›¸æ¯” Server Side åŒæ­¥ï¼ˆ5-10 åˆ†é˜ï¼‰å¤§å¹…æ”¹å–„

---

## 5. è¿´æ­¸æ¸¬è©¦ (Regression Testing)

### 5.1 ç¡¬é«”ç›¸æ©Ÿé…å°åŠŸèƒ½è¿´æ­¸æ¸¬è©¦
**æ¸¬è©¦ç›®æ¨™**ï¼šé©—è­‰ç¡¬é«”ç›¸æ©Ÿé…å°åŠŸèƒ½æœªå—å½±éŸ¿

**å‰ç½®æ¢ä»¶**ï¼š
- æº–å‚™ç¡¬é«”ç›¸æ©Ÿï¼ˆAC101/AC201/AC202ï¼‰
- æº–å‚™æ¸¬è©¦å¸³è™Ÿ

**æ¸¬è©¦æ­¥é©Ÿ**ï¼š
1. æ¸¬è©¦ AC101 é…å°æµç¨‹
2. æ¸¬è©¦ AC201 é…å°æµç¨‹
3. æ¸¬è©¦ AC202 é…å°æµç¨‹
4. é©—è­‰é…å°å®Œæˆå¾Œï¼š
   - ç›¸æ©Ÿæ­£å¸¸é¡¯ç¤ºåœ¨åˆ—è¡¨ä¸­
   - èƒ½æ­£å¸¸é€²å…¥ Live ç•«é¢
   - èƒ½æ­£å¸¸è§€çœ‹å³æ™‚å½±åƒ
   - é…å°ç‹€æ…‹æ­£ç¢º

**é æœŸçµæœ**ï¼š
- æ‰€æœ‰ç¡¬é«”ç›¸æ©Ÿé…å°åŠŸèƒ½æ­£å¸¸
- é…å°æµç¨‹èˆ‡ä¹‹å‰ç‰ˆæœ¬ä¸€è‡´
- ç„¡å›æ­¸å•é¡Œ

---

### 5.2 è¨‚é–±è³¼è²·åŠŸèƒ½è¿´æ­¸æ¸¬è©¦
**æ¸¬è©¦ç›®æ¨™**ï¼šé©—è­‰è¨‚é–±è³¼è²·åŠŸèƒ½æœªå—å½±éŸ¿

**å‰ç½®æ¢ä»¶**ï¼š
- æº–å‚™æ¸¬è©¦å¸³è™Ÿ
- æº–å‚™è¨‚é–±è³¼è²·æµç¨‹

**æ¸¬è©¦æ­¥é©Ÿ**ï¼š
1. æ¸¬è©¦ Premium è¨‚é–±è³¼è²·ï¼ˆæœˆä»˜ï¼‰
2. æ¸¬è©¦ Premium è¨‚é–±è³¼è²·ï¼ˆå¹´ä»˜ï¼‰
3. æ¸¬è©¦ Plus è¨‚é–±è³¼è²·ï¼ˆæœˆä»˜ï¼‰
4. æ¸¬è©¦ Plus è¨‚é–±è³¼è²·ï¼ˆå¹´ä»˜ï¼‰
5. é©—è­‰è¨‚é–±è³¼è²·å®Œæˆå¾Œï¼š
   - è¨‚é–±ç‹€æ…‹æ­£ç¢ºæ›´æ–°
   - Premium/Plus åŠŸèƒ½æ­£å¸¸è§£é–
   - è¨‚é–±ç®¡ç†é é¢é¡¯ç¤ºæ­£ç¢º

**é æœŸçµæœ**ï¼š
- æ‰€æœ‰è¨‚é–±è³¼è²·åŠŸèƒ½æ­£å¸¸
- è¨‚é–±ç‹€æ…‹æ­£ç¢ºæ›´æ–°
- Premium/Plus åŠŸèƒ½æ­£å¸¸è§£é–
- ç„¡å›æ­¸å•é¡Œ

---

### 5.3 ç”¨æˆ¶æ¬Šé™èˆ‡è¨‚é–±è¿´æ­¸æ¸¬è©¦
**æ¸¬è©¦ç›®æ¨™**ï¼šé©—è­‰ç”¨æˆ¶æ¬Šé™èˆ‡è¨‚é–±åŠŸèƒ½æœªå—å½±éŸ¿

**å‰ç½®æ¢ä»¶**ï¼š
- æº–å‚™ä¸åŒé¡å‹çš„æ¸¬è©¦å¸³è™Ÿï¼ˆFreeã€Premiumã€Plusï¼‰

**æ¸¬è©¦æ­¥é©Ÿ**ï¼š
1. æ¸¬è©¦ Free ç”¨æˆ¶æ¬Šé™ï¼š
   - é©—è­‰å…è²»åŠŸèƒ½æ­£å¸¸
   - é©—è­‰ä»˜è²»åŠŸèƒ½é™åˆ¶æ­£ç¢º
2. æ¸¬è©¦ Premium ç”¨æˆ¶æ¬Šé™ï¼š
   - é©—è­‰ Premium åŠŸèƒ½æ­£å¸¸è§£é–
   - é©—è­‰å»£å‘Šä¸é¡¯ç¤º
3. æ¸¬è©¦ Plus ç”¨æˆ¶æ¬Šé™ï¼š
   - é©—è­‰ Plus åŠŸèƒ½æ­£å¸¸è§£é–
   - é©—è­‰å»£å‘Šä¸é¡¯ç¤º
4. æ¸¬è©¦è¨‚é–±è½‰æ›ï¼š
   - Free â†’ Premium
   - Free â†’ Plus
   - Premium â†’ Plus
   - Plus â†’ Premium

**é æœŸçµæœ**ï¼š
- æ‰€æœ‰ç”¨æˆ¶æ¬Šé™åŠŸèƒ½æ­£å¸¸
- è¨‚é–±è½‰æ›æ­£å¸¸
- ç„¡å›æ­¸å•é¡Œ

---

### 5.4 ç¾æœ‰ User Properties åŒæ­¥è¿´æ­¸æ¸¬è©¦
**æ¸¬è©¦ç›®æ¨™**ï¼šé©—è­‰ç¾æœ‰çš„ Server Side User Properties åŒæ­¥æ©Ÿåˆ¶æœªå—å½±éŸ¿

**å‰ç½®æ¢ä»¶**ï¼š
- æº–å‚™æ¸¬è©¦å¸³è™Ÿ

**æ¸¬è©¦æ­¥é©Ÿ**ï¼š
1. åŸ·è¡Œå„ç¨®æ“ä½œï¼ˆç™»å…¥ã€é…å°ã€è¨‚é–±ç­‰ï¼‰
2. ç­‰å¾… Server Side åŒæ­¥ï¼ˆ5-10 åˆ†é˜ï¼‰
3. æª¢æŸ¥ Third-Party å¾Œå°ï¼š
   - é©—è­‰ç¾æœ‰å±¬æ€§ä»ç„¶æ­£ç¢ºåŒæ­¥
   - é©—è­‰æ–°å±¬æ€§èˆ‡ç¾æœ‰å±¬æ€§ä¸è¡çª
4. é©—è­‰ Client ç«¯å’Œ Server Side åŒæ­¥å…±å­˜

**é æœŸçµæœ**ï¼š
- ç¾æœ‰ Server Side åŒæ­¥æ©Ÿåˆ¶æ­£å¸¸é‹ä½œ
- æ–°å±¬æ€§èˆ‡ç¾æœ‰å±¬æ€§ä¸è¡çª
- Client ç«¯å’Œ Server Side åŒæ­¥å…±å­˜æ­£å¸¸

---

## ğŸ“Š æ¸¬è©¦ç¸½çµ

### æ¸¬è©¦è¦†è“‹ç¯„åœ
- âœ… åŠŸèƒ½èˆ‡æ¥­å‹™é‚è¼¯æ¸¬è©¦ï¼ˆ12 å€‹æ¸¬è©¦æ¡ˆä¾‹ï¼‰
- âœ… ç©©å®šæ€§èˆ‡å¯é æ€§æ¸¬è©¦ï¼ˆ5 å€‹æ¸¬è©¦æ¡ˆä¾‹ï¼‰
- âœ… ä½¿ç”¨è€…é«”é©—æ¸¬è©¦ï¼ˆ2 å€‹æ¸¬è©¦æ¡ˆä¾‹ï¼‰
- âœ… æ•ˆèƒ½æ¸¬è©¦ï¼ˆ2 å€‹æ¸¬è©¦æ¡ˆä¾‹ï¼‰
- âœ… è¿´æ­¸æ¸¬è©¦ï¼ˆ4 å€‹æ¸¬è©¦æ¡ˆä¾‹ï¼‰

**ç¸½è¨ˆï¼š25 å€‹æ¸¬è©¦æ¡ˆä¾‹**

### é—œéµæ¸¬è©¦é …ç›®
1. **ç¡¬é«”è£ç½®é…å°å®Œæˆå¾ŒåŒæ­¥**ï¼š`eligible_hw_free_trial`ã€`is_alfredcam_owner` å±¬æ€§åŒæ­¥
2. **è¨‚é–±è³¼è²·å®Œæˆå¾ŒåŒæ­¥**ï¼šæ‰€æœ‰è¨‚é–±ç›¸é—œå±¬æ€§åŒæ­¥ï¼ŒPolling æ©Ÿåˆ¶é©—è­‰
3. **å‹æ…‹è½‰æ›æ¸¬è©¦**ï¼šBoolean â†’ Stringï¼ˆRevenueCatï¼‰ï¼ŒString â†’ Stringï¼ˆAmplitudeã€Appcuesï¼‰
4. **Polling æ©Ÿåˆ¶æ¸¬è©¦**ï¼šæˆåŠŸå ´æ™¯ã€æœ€å¤§é‡è©¦æ¬¡æ•¸ã€éŒ¯èª¤è™•ç†
5. **Properties Cache æ¸¬è©¦**ï¼šæœ‰è®Šæ›´æ‰æ‰“ä¸Šå»
6. **å‘ä¸‹å…¼å®¹æ€§æ¸¬è©¦**ï¼šèˆŠç‰ˆ Client ä»å¯ä½¿ç”¨æ—¢æœ‰æ¬„ä½
7. **ç¶²è·¯ç•°å¸¸æ¸¬è©¦**ï¼šAPI å¤±æ•—ã€å¼±ç¶²ã€ç¶²è·¯ä¸­æ–·æ¢å¾©
8. **è¿´æ­¸æ¸¬è©¦**ï¼šç¡¬é«”ç›¸æ©Ÿé…å°ã€è¨‚é–±è³¼è²·ã€ç”¨æˆ¶æ¬Šé™ã€ç¾æœ‰åŒæ­¥æ©Ÿåˆ¶

### é¢¨éšªè©•ä¼°
- **é«˜é¢¨éšªé …ç›®**ï¼š
  - è¨‚é–±è³¼è²·æµç¨‹é‡æ§‹ï¼ˆå®Œå…¨é‡æ§‹è¨‚é–±å±¬æ€§åŒæ­¥æ©Ÿåˆ¶ï¼‰
  - ç¡¬é«”è£ç½®é…å° API è®Šæ›´ï¼ˆæ–°å¢ Response æ¬„ä½ï¼‰
  - User Properties åŒæ­¥æ©Ÿåˆ¶è®Šæ›´ï¼ˆæ–°å¢ Client ç«¯åŒæ­¥ï¼‰
- **ä¸­é¢¨éšªé …ç›®**ï¼š
  - Polling æ©Ÿåˆ¶ï¼ˆå¯èƒ½å¢åŠ ç¶²è·¯è² è¼‰å’Œé›»æ± æ¶ˆè€—ï¼‰
  - å‹æ…‹è½‰æ›ï¼ˆå¯èƒ½å°è‡´è³‡æ–™éŒ¯èª¤ï¼‰
  - å‘ä¸‹å…¼å®¹æ€§ï¼ˆèˆŠç‰ˆ Client å¯èƒ½å—å½±éŸ¿ï¼‰

### æ¸¬è©¦å»ºè­°
1. **å„ªå…ˆæ¸¬è©¦é …ç›®**ï¼š
   - ç¡¬é«”è£ç½®é…å°å®Œæˆå¾ŒåŒæ­¥ï¼ˆæ ¸å¿ƒåŠŸèƒ½ï¼š`eligible_hw_free_trial`ã€`is_alfredcam_owner`ï¼‰
   - è¨‚é–±è³¼è²·å®Œæˆå¾ŒåŒæ­¥ï¼ˆæ ¸å¿ƒåŠŸèƒ½ï¼šæ‰€æœ‰è¨‚é–±å±¬æ€§ï¼‰
   - Polling æ©Ÿåˆ¶é©—è­‰ï¼ˆæˆåŠŸå ´æ™¯ã€æœ€å¤§é‡è©¦æ¬¡æ•¸ï¼‰

2. **é‡é»é©—è­‰é …ç›®**ï¼š
   - å‹æ…‹è½‰æ›æ­£ç¢ºæ€§ï¼ˆBoolean â†’ String for RevenueCatï¼‰
   - Properties Cache æ©Ÿåˆ¶
   - å‘ä¸‹å…¼å®¹æ€§

3. **ç›£æ§æŒ‡æ¨™**ï¼š
   - å±¬æ€§åŒæ­¥æˆåŠŸç‡ > 95%
   - å±¬æ€§åŒæ­¥å»¶é² < 10 ç§’ï¼ˆç›¸æ¯” Server Side 5-10 åˆ†é˜å¤§å¹…æ”¹å–„ï¼‰
   - API èª¿ç”¨å¤±æ•—ç‡ < 5%
   - ç”¨æˆ¶é«”é©—ä¸å—å½±éŸ¿ï¼ˆè³¼è²·æµç¨‹é †æš¢ï¼‰

---

## ğŸ“ æ¸¬è©¦è¨˜éŒ„

### æ¸¬è©¦ç’°å¢ƒ
- **æ¸¬è©¦æ—¥æœŸ**ï¼šå¾…å¡«å¯«
- **æ¸¬è©¦äººå“¡**ï¼šå¾…å¡«å¯«
- **æ¸¬è©¦è¨­å‚™**ï¼š
  - Android è¨­å‚™ï¼šå¾…å¡«å¯«
  - **Android ç‰ˆæœ¬**ï¼šå¾…å¡«å¯«ï¼ˆéœ€æ¸¬è©¦æœ€æ–°å®˜æ–¹ Android ç‰ˆæœ¬ï¼ŒåŸºæ–¼ Test_Scenario.mdï¼‰
- **App ç‰ˆæœ¬**ï¼šAndroid - 2025.26.0
- **æ¸¬è©¦å ´æ™¯**ï¼šå¾…å¡«å¯«
- **æ¸¬è©¦å¸³è™Ÿ**ï¼š
  - Free å¸³è™Ÿï¼šå¾…å¡«å¯«
  - Premium å¸³è™Ÿï¼šå¾…å¡«å¯«
  - Plus å¸³è™Ÿï¼šå¾…å¡«å¯«
  - ç¡¬é«”ç›¸æ©Ÿ Owner å¸³è™Ÿï¼šå¾…å¡«å¯«
  - ç¡¬é«”ç›¸æ©Ÿé Owner å¸³è™Ÿï¼šå¾…å¡«å¯«

### æ¸¬è©¦çµæœ
- **é€šéé …ç›®**ï¼šå¾…å¡«å¯«
- **å¤±æ•—é …ç›®**ï¼šå¾…å¡«å¯«
- **é˜»å¡å•é¡Œ**ï¼šå¾…å¡«å¯«
- **å·²çŸ¥å•é¡Œ**ï¼šå¾…å¡«å¯«

---

## ğŸ”— ç›¸é—œé€£çµ
- **Jira Ticket**: [CAMERA-6103](https://alfredlabs.atlassian.net/browse/CAMERA-6103)
- **Parent Epic**: [CAMERA-6093](https://alfredlabs.atlassian.net/browse/CAMERA-6093) - Fix the latency issue of server-side user properties syncing to Appcues
- **æŠ€è¡“è¦æ ¼æ–‡ä»¶**: [User Property Sync Mechanism for Third-Party Services](https://alfredlabs.atlassian.net/wiki/spaces/PD/pages/4485054466/User+Property+Sync+Mechanism+for+Third-Party+Services)
- **GitHub PR**: [PR #5256](https://github.com/alfred-systems/iVuu/pull/5256) - [Android] Sync the user properties to Appcues to fix the latency issue from the server side (CAMERA-6103)
- **ç”¢å“å°ˆæœ‰åè©**: [Terminology Table v2](https://alfredlabs.atlassian.net/wiki/spaces/~590960658/pages/3834085744/Terminology+Table+v2) - é˜¿è¤”ç®¡å®¶ APP ç”¢å“å°ˆæœ‰åè©åƒè€ƒ
- **é¢¨éšªè©•ä¼°å ±å‘Š**: è¦‹ Jira Ticket è©•è«–ï¼ˆPR #5256 é¢¨éšªè©•ä¼°ï¼‰

---

## ğŸ“š æŠ€è¡“ç´°ç¯€åƒè€ƒ

### API ç«¯é»
1. **æ—¢æœ‰ API**ï¼ˆç¡¬é«”è£ç½®é…å°å®Œæˆå¾Œï¼‰ï¼š
   - `GET "/v2.6/device/pairing/{code}/paired"`
   - æ–°å¢ Response æ¬„ä½ï¼š`eligible_hw_free_trial`ã€`is_alfredcam_owner`

2. **æ–°å¢ API**ï¼ˆè¨‚é–±è³¼è²·å®Œæˆå¾Œï¼‰ï¼š
   - `GET "/entitlement/v1/attributes/subscription"`
   - [API Spec](https://api.my-alfred-dev.com/entitlement/docs#/attributes/get_entitlement_v1_attributes_subscription)
   - Response æ¬„ä½ï¼š`subscription_tier`ã€`subscription_cycle_iso`ã€`subscription_cycle_first`ã€`subscription_channel`ã€`subscription_cancelled`ã€`subscription_expiration_date`ã€`subscription_product_id`

### User Properties åˆ—è¡¨
| Property | Type | Amplitude | Appcues | RC | Timing |
| --- | --- | --- | --- | --- | --- |
| `eligible_hw_free_trial` | String | âœ… | âœ… | âœ… | ç¡¬é«”è£ç½®é…å°å®Œæˆå¾Œ |
| `is_alfredcam_owner` | Boolean | âœ… | âœ… | âœ… | ç¡¬é«”è£ç½®é…å°å®Œæˆå¾Œ |
| `subscription_tier` | String | âœ… | âœ… | âœ… | è¨‚é–±è³¼è²·å®Œæˆå¾Œ |
| `subscription_cycle_iso` | String | âœ… | âœ… | âœ… | è¨‚é–±è³¼è²·å®Œæˆå¾Œ |
| `subscription_cycle_first` | Boolean | âœ… | âœ… | âœ… | è¨‚é–±è³¼è²·å®Œæˆå¾Œ |
| `subscription_channel` | String | âœ… | âœ… | âœ… | è¨‚é–±è³¼è²·å®Œæˆå¾Œ |
| `subscription_cancelled` | Boolean | âœ… | âœ… | âœ… | è¨‚é–±è³¼è²·å®Œæˆå¾Œ |
| `subscription_expiration_date` | String | âœ… | âœ… | âŒ | è¨‚é–±è³¼è²·å®Œæˆå¾Œ |
| `subscription_product_id` | String | âœ… | âœ… | âœ… | è¨‚é–±è³¼è²·å®Œæˆå¾Œ |

### Polling æ©Ÿåˆ¶
- **è¼ªè©¢é–“éš”**ï¼šæ¯ 1 ç§’è¼ªè©¢ä¸€æ¬¡
- **æœ€å¤§é‡è©¦æ¬¡æ•¸**ï¼š5 æ¬¡
- **ç¸½ç­‰å¾…æ™‚é–“**ï¼šæœ€å¤š 5 ç§’
- **æˆåŠŸæ¢ä»¶**ï¼šAPI å›å‚³ `updated = true`
- **éŒ¯èª¤è™•ç†**ï¼šä¸è«–æ˜¯å¦æœ‰ Timeout æˆ– API Error éƒ½éœ€è¦é‡è¤‡å˜—è©¦ç›´åˆ° 5 ç§’ç‚ºæ­¢

### å‹æ…‹è½‰æ›è¦å‰‡
- **Amplitude**ï¼šå¯ä»¥åƒ Booleanï¼ŒClient ç›´æ¥çµ¦ä»– Boolean
- **Appcues**ï¼šå¯ä»¥åƒ Booleanï¼ŒClient ç›´æ¥çµ¦ä»– Boolean
- **RevenueCat**ï¼šåªåƒ Stringï¼Œçµ±ä¸€ç”± Client åšå‹æ…‹è½‰æ›ï¼ˆBoolean â†’ Stringï¼‰

### Properties Cache è¦å‰‡
- æœ‰è®Šæ›´æ‰æ‰“ä¸Šå»
- è‹¥å±¬æ€§ç‚º `null`ï¼ˆæ²’é€™æ¬„ä½ï¼‰ï¼Œå‰‡å¿½ç•¥ä¸æ›´æ–°è©²åƒæ•¸
- è‹¥å±¬æ€§ç‚ºç©ºå­—ä¸² `""`ï¼Œè¦–åŒçµ¦äºˆåƒæ•¸ï¼Œæ›´æ–°è‡³ Third-Party

### ç¨‹å¼ç¢¼è®Šæ›´é‡é»
1. **æ–°å¢è¨‚é–±å±¬æ€§ API æ•´åˆ**ï¼š
   - ä½¿ç”¨æ–° API (`GET "/entitlement/v1/attributes/subscription"`) å–ä»£èˆŠæœ‰å…©æ”¯ API
   - å¯¦ä½œ Polling æ©Ÿåˆ¶ï¼ˆæ¯ 1 ç§’è¼ªè©¢ä¸€æ¬¡ï¼Œæœ€å¤š 5 æ¬¡ï¼‰

2. **æ—¢æœ‰é…å° API æ›´æ–°**ï¼š
   - API Response æ–°å¢æ¬„ä½ï¼š`eligible_hw_free_trial`ã€`is_alfredcam_owner`
   - å‘ä¸‹å…¼å®¹ï¼šèˆŠç‰ˆ Client ä»å¯ä½¿ç”¨æ—¢æœ‰æ¬„ä½

3. **User Properties åŒæ­¥é‚è¼¯**ï¼š
   - æ–°å¢ Client ç«¯åŒæ­¥é‚è¼¯
   - å‹æ…‹è½‰æ›ï¼ˆBoolean â†’ String for RevenueCatï¼‰
   - Properties Cache æ©Ÿåˆ¶

4. **éŒ¯èª¤è™•ç†å’Œå›é€€æ©Ÿåˆ¶**ï¼š
   - API å¤±æ•—æ™‚çš„é‡è©¦é‚è¼¯
   - å›é€€åˆ°èˆŠç‰ˆ RC å±¬æ€§åŒæ­¥æ©Ÿåˆ¶ï¼ˆè‹¥éœ€è¦ï¼‰
